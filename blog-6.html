<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>    Building an Image Classification Model
</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
            <link rel="stylesheet" href="https://vishalsharma01.github.io/Blog/theme/css/normalize.css">
        <link href='//fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>
        <link href='//fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
        <link rel="stylesheet" href="https://vishalsharma01.github.io/Blog/theme/css/font-awesome.min.css">
        <link rel="stylesheet" href="https://vishalsharma01.github.io/Blog/theme/css/main.css">

    <link rel="stylesheet" href="https://vishalsharma01.github.io/Blog/theme/css/blog.css">
    <link rel="stylesheet" href="https://vishalsharma01.github.io/Blog/theme/css/github.css">
        <link href="https://vishalsharma01.github.io/Blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="My Blog Atom Feed" />
        <script src="https://vishalsharma01.github.io/Blog/theme/js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
    <body>
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

        <div id="wrapper">
<header id="sidebar" class="side-shadow">
    <hgroup id="site-header">
        <a id="site-title" href="https://vishalsharma01.github.io/Blog"><h1><i class="icon-coffee"></i> My Blog</h1></a>
        <p id="site-desc"></p>
    </hgroup>
    <nav>
        <ul id="nav-links">
                <li><a href="https://vishalsharma01.github.io/Blog/">Blog</a></li>
                <li><a href="https://vishalsharma01.github.io/Blog/contact">Contact</a></li>
                <li><a href="https://vishalsharma01.github.io/Blog/projects">Projects</a></li>
        </ul>
    </nav>
<footer id="site-info">
    <p class='social'>
        Blog by Vishal Sharma
        <!-- <a href="http://getpelican.com/" target="pelican">Pelican</a> and <a href="http://python.org/" target="python">Python</a>. Theme by <a href="https://github.com/hdra/pelican-cait" target="github">hndr</a>.
    </p>
    <p>
        Textures by <a href="http://subtlepatterns.com/" target="subtlepatterns">Subtle Pattern</a>. Font Awesome by <a href="http://fortawesome.github.io/Font-Awesome/" target="github">Dave Grandy</a>.
    </p> -->

<!-- <a href="https://www.linkedin.com/in/vishal-sharma01/" target="_blank"><img src="https://github.com/vishalsharma01/Blog/blob/gh-pages/images/linkedin.png">
<!-- <img src="https://github.com/vishalsharma01/Blog/blob/gh-pages/images/linkedin.png"> -->
<!-- </a> -->

<!-- <a href="https://github.com/vishalsharma01" target="_blank"><img src="https://github.com/vishalsharma01/Blog/blob/gh-pages/images/github.png"></a>
<!--<a href="https://github.com/vishalsharma01" rel="alternate">
        <img src="https://github.com/vishalsharma01/Blog/blob/gh-pages/images/github.png"></a>

</p>
</footer> --></header>
    <div id="post-container">
        <ol id="post-list">
            <li>
                <article class="post-entry">
                    <header class="entry-header">
                        <time class="post-time" datetime="2019-08-08T00:00:00-04:00" pubdate>
                            Thu 08 August 2019
                        </time>
                        <a href="https://vishalsharma01.github.io/Blog/blog-6.html" rel="bookmark"><h1>Building an Image Classification Model</h1></a>
                    </header>

                    <section class="post-content">
                        <p>Using <strong>Deep Learning</strong> theres a vast amount of amazing things we can acheive. One of them being creating a model to classify images. </p>
<p>Using <strong>CNN</strong> (convolutional neural networks) we can analyze images and train models to understand and classify those images.</p>
<p>In this post I am going to go over the steps I took to create an Image classifying model which I did for a personal project.</p>
<p><em>(I will try to break down the steps and keep it simple as possible so anyone following along can keep up.)</em></p>
<p><img alt="deeplearning.png" src="images/deeplearning.png"></p>
<h3>Step 1: Choosing your data source</h3>
<p>Theres many datasets that you can download off the internet to follow along with this tutorial. One of the most famous ones being the <a href="https://github.com/zalandoresearch/fashion-mnist">MNIST-Fashion</a></p>
<p>For my own personal project I decided to create a model that classifed sports images. I wanted to be able to classify images across "Baseball, Basketball, Football, Hockey, and Soccer". To do this I web-scraped images off of Google and created my own data set.</p>
<p>If you are interested in following this route theres a very handy Python Package that you can use that will allow you to download your images very easily called the <a href="https://github.com/hardikvasa/google-images-download">Google Images Downloader</a></p>
<h3>Step 2: Get the Data</h3>
<p>Like I mentioned in the first step I chose to web-scrape my own images to use to train my model. </p>
<p>If you have gone ahead and installed the "Google Images Downloader" package then your code should look something like this:</p>
<p><em>(before going any further I would suggest creating a folder where you can store all the work we're going to be doing)</em></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google_images_download</span> <span class="kn">import</span> <span class="n">google_images_download</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">response</span> <span class="o">=</span> <span class="n">google_images_download</span><span class="o">.</span><span class="n">googleimagesdownload</span><span class="p">()</span>   

<span class="n">arguments</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;keywords&quot;</span><span class="p">:</span><span class="s2">&quot;Baseball&quot;</span><span class="p">,</span><span class="s2">&quot;Basketball&quot;</span><span class="p">,</span><span class="s2">&quot;Hockey&quot;</span><span class="p">,</span><span class="s2">&quot;Football&quot;</span><span class="p">,</span><span class="s2">&quot;Soccer&quot;</span> <span class="c1">#creating list of arguments</span>
             <span class="s2">&quot;limit&quot;</span><span class="p">:</span><span class="mi">1500</span><span class="p">,</span> <span class="c1">#Specify # of images to download per argument</span>
             <span class="s2">&quot;format&quot;</span><span class="p">:</span><span class="s2">&quot;png&quot;</span><span class="p">,</span> <span class="c1">#Specify file type (optional)</span>
             <span class="s2">&quot;size&quot;</span><span class="p">:</span> <span class="s2">&quot;medium&quot;</span> <span class="c1">#size of file (optional)</span>
             <span class="s2">&quot;print_urls&quot;</span><span class="p">:</span><span class="bp">True</span><span class="p">,</span> <span class="c1">#print file url (optional)</span>
             <span class="s2">&quot;chromedriver&quot;</span><span class="p">:</span><span class="s2">&quot;C:</span><span class="se">\\</span><span class="s2">Users</span><span class="se">\\</span><span class="s2">v_sha</span><span class="se">\\</span><span class="s2">OneDrive</span><span class="se">\\</span><span class="s2">Desktop</span><span class="se">\\</span><span class="s2">chromedriver_win32 (1)</span><span class="se">\\</span><span class="s2">chromedriver.exe&quot;</span><span class="p">}</span>   
<span class="n">paths</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">arguments</span><span class="p">)</span>   <span class="c1">#passing the arguments to the function</span>
<span class="k">print</span><span class="p">(</span><span class="n">paths</span><span class="p">)</span>   <span class="c1">#printing absolute paths of the downloaded images</span>
</pre></div>


<p><em>("chromedriver" is needed to scroll through Google for images because only a certain amount are shown at once. More information can be found on the Google Images Downloader documentation page)</em></p>
<p>Running this code allowed me to download approximately 1500 images for each of my arguments (Baseball, Basketball, Hockey, Football and Soccer). I say <strong>approximately</strong> because some images can be corrupted and wont be downloaded.</p>
<p>The images should all be stored in a folder called downloads and there should be sub-folders for each argument(sport).</p>
<p><em>Once again, I chose to classify sports images for my own personal project, you can use what ever you like to follow along.</em></p>
<h3>Step 3: Load in Data(images)</h3>
<p><strong>Import Libraries</strong></p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelBinarizer</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>

<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Activation</span><span class="p">,</span> <span class="n">Flatten</span><span class="p">,</span> <span class="n">Input</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Conv2D</span><span class="p">,</span> <span class="n">MaxPooling2D</span>
<span class="kn">from</span> <span class="nn">tensorflow.keras.utils</span> <span class="kn">import</span> <span class="n">to_categorical</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">,</span> <span class="s1">&#39;WARNING&#39;</span><span class="p">)</span>


<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
</pre></div>


<p><strong>Retrieve and list out Image folders in downloads</strong></p>
<div class="highlight"><pre><span></span><span class="n">folder_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s2">&quot;./downloads&quot;</span><span class="p">)]</span>

<span class="n">folder_names</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;Baseball&#39;</span><span class="p">,</span> <span class="s1">&#39;Basketball&#39;</span><span class="p">,</span> <span class="s1">&#39;Football&#39;</span><span class="p">,</span> <span class="s1">&#39;Hockey&#39;</span><span class="p">,</span> <span class="s1">&#39;Soccer&#39;</span><span class="p">]</span>
</pre></div>


<p><strong>Create X and y variables for training and test images/Load images</strong></p>
<div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">folder</span> <span class="ow">in</span> <span class="n">folder_names</span><span class="p">:</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;downloads/&quot;</span> <span class="o">+</span> <span class="n">folder</span> <span class="o">+</span> <span class="s2">&quot;/*&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="nb">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="nb">file</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">))</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="s2">&quot;float32&quot;</span><span class="p">)</span>
        <span class="n">img</span> <span class="o">/=</span> <span class="mi">255</span>
        <span class="k">if</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">folder</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">C</span><span class="p">:</span><span class="err">\</span><span class="n">Users</span><span class="err">\</span><span class="n">v_sha</span><span class="err">\</span><span class="n">AppData</span><span class="err">\</span><span class="k">Local</span><span class="err">\</span><span class="n">Programs</span><span class="err">\</span><span class="n">Python</span><span class="err">\</span><span class="n">Python37</span><span class="err">\</span><span class="n">lib</span><span class="err">\</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="err">\</span><span class="n">PIL</span><span class="err">\</span><span class="n">TiffImagePlugin</span><span class="p">.</span><span class="n">py</span><span class="p">:</span><span class="mi">804</span><span class="p">:</span> <span class="n">UserWarning</span><span class="p">:</span> <span class="n">Corrupt</span> <span class="n">EXIF</span> <span class="k">data</span><span class="p">.</span>  <span class="n">Expecting</span> <span class="k">to</span> <span class="k">read</span> <span class="mi">4</span> <span class="n">bytes</span> <span class="n">but</span> <span class="k">only</span> <span class="n">got</span> <span class="mi">0</span><span class="p">.</span> 
  <span class="n">warnings</span><span class="p">.</span><span class="n">warn</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
</pre></div>


<p><strong>Convert Data into Array and Inspect Shape</strong></p>
<div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

<span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">3329</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>


<p><strong>Inspect Image</strong></p>
<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="p">.</span><span class="n">image</span><span class="p">.</span><span class="n">AxesImage</span> <span class="k">at</span> <span class="mi">0</span><span class="n">x1ab070d0a48</span><span class="o">&gt;</span>
</pre></div>


<p><img alt="output_39_1.png" src="images/output_39_1.png"></p>
<p>Now that we have loaded in our images and created our <strong>Test</strong> and <strong>Train</strong> set we can start prepping the data for the model</p>
<p><strong>Train-Test-Split:</strong></p>
<div class="highlight"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>


<p><strong>Create Label (classes) for Images:</strong></p>
<div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;Baseball&quot;</span><span class="p">,</span>
    <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;Basketball&quot;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;Football&quot;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span> <span class="s2">&quot;Hockey&quot;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;Soccer&quot;</span>
<span class="p">}</span>

<span class="n">y_train</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">array</span><span class="p">([</span><span class="s1">&#39;Basketball&#39;</span><span class="p">,</span> <span class="s1">&#39;Hockey&#39;</span><span class="p">,</span> <span class="s1">&#39;Football&#39;</span><span class="p">,</span> <span class="s1">&#39;Soccer&#39;</span><span class="p">,</span> <span class="s1">&#39;Football&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U10&#39;</span><span class="p">)</span>
</pre></div>


<p>I now have 5 classes representing the 5 different sports images I am aiming to classify.</p>
<p><strong>LabelBinarize() and Transform Data:</strong></p>
<div class="highlight"><pre><span></span><span class="n">lb</span> <span class="o">=</span> <span class="n">LabelBinarizer</span><span class="p">()</span>

<span class="n">y_train</span> <span class="o">=</span> <span class="n">lb</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">lb</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">y_test</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">lb</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">[[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">array</span><span class="p">([</span><span class="s1">&#39;Basketball&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U10&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,</span> <span class="p">:,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="p">.</span><span class="n">image</span><span class="p">.</span><span class="n">AxesImage</span> <span class="k">at</span> <span class="mi">0</span><span class="n">x1ab07150288</span><span class="o">&gt;</span>
</pre></div>


<p><img alt="output_53_1.png" src="images/output_53_1.png"></p>
<p>As you can see, once we apply <strong>LabelBinarizer</strong> and <strong>Transform</strong> our data the images look different</p>
<p>Now for the good stuff! Time start creating our Model:</p>
<p><strong>Instantiate and Create Model</strong></p>
<div class="highlight"><pre><span></span><span class="c1">#Instantiate Model</span>

<span class="n">cnn_model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>

<span class="c1"># Add a convolutional layer</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">filters</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
                     <span class="n">kernel_size</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
                     <span class="n">activation</span> <span class="o">=</span> <span class="s2">&quot;relu&quot;</span><span class="p">,</span>
                    <span class="n">input_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>

<span class="c1"># Add a pooling layer</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>

<span class="c1"># Add a second convolutional layer</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">kernel_size</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
                     <span class="n">filters</span> <span class="o">=</span> <span class="mi">16</span><span class="p">,</span>
                     <span class="n">activation</span> <span class="o">=</span> <span class="s2">&quot;relu&quot;</span><span class="p">))</span>

<span class="c1"># Add a second pooling layer</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>

<span class="c1"># Add a third convolutional layer</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Conv2D</span><span class="p">(</span><span class="n">kernel_size</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
                     <span class="n">filters</span> <span class="o">=</span> <span class="mi">26</span><span class="p">,</span>
                     <span class="n">activation</span> <span class="o">=</span> <span class="s2">&quot;relu&quot;</span><span class="p">))</span>

<span class="c1"># Add a third pooling layer</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">MaxPooling2D</span><span class="p">(</span><span class="n">pool_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>

<span class="c1"># Flatten the 3D array to 1D array</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Flatten</span><span class="p">())</span>

<span class="c1"># Add in first perceptrons</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s2">&quot;relu&quot;</span><span class="p">))</span>

<span class="c1"># Add in a Dropout</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>

<span class="c1"># Add in second perceptrons</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="n">activation</span> <span class="o">=</span> <span class="s2">&quot;relu&quot;</span><span class="p">))</span>

<span class="c1"># Add in a second Dropout</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dropout</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>

<span class="c1"># Output</span>
<span class="n">cnn_model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">lb</span><span class="o">.</span><span class="n">classes_</span><span class="p">),</span> <span class="n">activation</span> <span class="o">=</span> <span class="s2">&quot;softmax&quot;</span><span class="p">))</span>

<span class="n">cnn_model</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Model</span><span class="p">:</span> <span class="ss">&quot;sequential_2&quot;</span>
<span class="n">_________________________________________________________________</span>
<span class="n">Layer</span> <span class="p">(</span><span class="k">type</span><span class="p">)</span>                 <span class="k">Output</span> <span class="n">Shape</span>              <span class="n">Param</span> <span class="o">#</span>   
<span class="o">=================================================================</span>
<span class="n">conv2d_6</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>            <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">198</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>       <span class="mi">168</span>       
<span class="n">_________________________________________________________________</span>
<span class="n">max_pooling2d_6</span> <span class="p">(</span><span class="n">MaxPooling2</span> <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>         <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">conv2d_7</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>            <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>        <span class="mi">880</span>       
<span class="n">_________________________________________________________________</span>
<span class="n">max_pooling2d_7</span> <span class="p">(</span><span class="n">MaxPooling2</span> <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>        <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">conv2d_8</span> <span class="p">(</span><span class="n">Conv2D</span><span class="p">)</span>            <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>        <span class="mi">3770</span>      
<span class="n">_________________________________________________________________</span>
<span class="n">max_pooling2d_8</span> <span class="p">(</span><span class="n">MaxPooling2</span> <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">26</span><span class="p">)</span>          <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">flatten_2</span> <span class="p">(</span><span class="n">Flatten</span><span class="p">)</span>          <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">936</span><span class="p">)</span>               <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">dense_6</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>              <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>               <span class="mi">119936</span>    
<span class="n">_________________________________________________________________</span>
<span class="n">dropout_4</span> <span class="p">(</span><span class="n">Dropout</span><span class="p">)</span>          <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>               <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">dense_7</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>              <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>                <span class="mi">8256</span>      
<span class="n">_________________________________________________________________</span>
<span class="n">dropout_5</span> <span class="p">(</span><span class="n">Dropout</span><span class="p">)</span>          <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">64</span><span class="p">)</span>                <span class="mi">0</span>         
<span class="n">_________________________________________________________________</span>
<span class="n">dense_8</span> <span class="p">(</span><span class="n">Dense</span><span class="p">)</span>              <span class="p">(</span><span class="k">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>                 <span class="mi">325</span>       
<span class="o">=================================================================</span>
<span class="n">Total</span> <span class="n">params</span><span class="p">:</span> <span class="mi">133</span><span class="p">,</span><span class="mi">335</span>
<span class="n">Trainable</span> <span class="n">params</span><span class="p">:</span> <span class="mi">133</span><span class="p">,</span><span class="mi">335</span>
<span class="n">Non</span><span class="o">-</span><span class="n">trainable</span> <span class="n">params</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">_________________________________________________________________</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">cnn_model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s1">&#39;categorical_crossentropy&#39;</span><span class="p">,</span>
                 <span class="n">optimizer</span> <span class="o">=</span> <span class="s1">&#39;adam&#39;</span><span class="p">,</span>
                 <span class="n">metrics</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;accuracy&#39;</span><span class="p">])</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">history</span> <span class="o">=</span> <span class="n">cnn_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span>
                       <span class="n">y_train</span><span class="p">,</span>
                       <span class="n">batch_size</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                       <span class="n">validation_data</span> <span class="o">=</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span>
                       <span class="n">epochs</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
                       <span class="n">verbose</span> <span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">Train</span> <span class="k">on</span> <span class="mi">2496</span> <span class="n">samples</span><span class="p">,</span> <span class="n">validate</span> <span class="k">on</span> <span class="mi">833</span> <span class="n">samples</span>
<span class="n">Epoch</span> <span class="mi">1</span><span class="o">/</span><span class="mi">10</span>
<span class="mi">2496</span><span class="o">/</span><span class="mi">2496</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">31</span><span class="n">s</span> <span class="mi">12</span><span class="n">ms</span><span class="o">/</span><span class="n">sample</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">6120</span> <span class="o">-</span> <span class="n">acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2115</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">6009</span> <span class="o">-</span> <span class="n">val_acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2605</span>
<span class="n">Epoch</span> <span class="mi">2</span><span class="o">/</span><span class="mi">10</span>
<span class="mi">2496</span><span class="o">/</span><span class="mi">2496</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">29</span><span class="n">s</span> <span class="mi">12</span><span class="n">ms</span><span class="o">/</span><span class="n">sample</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">6022</span> <span class="o">-</span> <span class="n">acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2268</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">5963</span> <span class="o">-</span> <span class="n">val_acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2521</span>
<span class="n">Epoch</span> <span class="mi">3</span><span class="o">/</span><span class="mi">10</span>
<span class="mi">2496</span><span class="o">/</span><span class="mi">2496</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">29</span><span class="n">s</span> <span class="mi">12</span><span class="n">ms</span><span class="o">/</span><span class="n">sample</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">5875</span> <span class="o">-</span> <span class="n">acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2588</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">5820</span> <span class="o">-</span> <span class="n">val_acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3073</span>
<span class="n">Epoch</span> <span class="mi">4</span><span class="o">/</span><span class="mi">10</span>
<span class="mi">2496</span><span class="o">/</span><span class="mi">2496</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">29</span><span class="n">s</span> <span class="mi">12</span><span class="n">ms</span><span class="o">/</span><span class="n">sample</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">5807</span> <span class="o">-</span> <span class="n">acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">2628</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">5615</span> <span class="o">-</span> <span class="n">val_acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3205</span>
<span class="n">Epoch</span> <span class="mi">5</span><span class="o">/</span><span class="mi">10</span>
<span class="mi">2496</span><span class="o">/</span><span class="mi">2496</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">29</span><span class="n">s</span> <span class="mi">12</span><span class="n">ms</span><span class="o">/</span><span class="n">sample</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">5417</span> <span class="o">-</span> <span class="n">acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3037</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">4808</span> <span class="o">-</span> <span class="n">val_acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3950</span>
<span class="n">Epoch</span> <span class="mi">6</span><span class="o">/</span><span class="mi">10</span>
<span class="mi">2496</span><span class="o">/</span><span class="mi">2496</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">29</span><span class="n">s</span> <span class="mi">12</span><span class="n">ms</span><span class="o">/</span><span class="n">sample</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">4813</span> <span class="o">-</span> <span class="n">acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3409</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">3949</span> <span class="o">-</span> <span class="n">val_acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4550</span>
<span class="n">Epoch</span> <span class="mi">7</span><span class="o">/</span><span class="mi">10</span>
<span class="mi">2496</span><span class="o">/</span><span class="mi">2496</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">29</span><span class="n">s</span> <span class="mi">12</span><span class="n">ms</span><span class="o">/</span><span class="n">sample</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">4035</span> <span class="o">-</span> <span class="n">acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">3870</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">3110</span> <span class="o">-</span> <span class="n">val_acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4754</span>
<span class="n">Epoch</span> <span class="mi">8</span><span class="o">/</span><span class="mi">10</span>
<span class="mi">2496</span><span class="o">/</span><span class="mi">2496</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">29</span><span class="n">s</span> <span class="mi">12</span><span class="n">ms</span><span class="o">/</span><span class="n">sample</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">3337</span> <span class="o">-</span> <span class="n">acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4403</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">2511</span> <span class="o">-</span> <span class="n">val_acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5414</span>
<span class="n">Epoch</span> <span class="mi">9</span><span class="o">/</span><span class="mi">10</span>
<span class="mi">2496</span><span class="o">/</span><span class="mi">2496</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">29</span><span class="n">s</span> <span class="mi">12</span><span class="n">ms</span><span class="o">/</span><span class="n">sample</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">2757</span> <span class="o">-</span> <span class="n">acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4692</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">1841</span> <span class="o">-</span> <span class="n">val_acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5582</span>
<span class="n">Epoch</span> <span class="mi">10</span><span class="o">/</span><span class="mi">10</span>
<span class="mi">2496</span><span class="o">/</span><span class="mi">2496</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">29</span><span class="n">s</span> <span class="mi">12</span><span class="n">ms</span><span class="o">/</span><span class="n">sample</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">2210</span> <span class="o">-</span> <span class="n">acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">4980</span> <span class="o">-</span> <span class="n">val_loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">1380</span> <span class="o">-</span> <span class="n">val_acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">6014</span>
</pre></div>


<p>So we have just created a model that has an accuracy of roughly 60%. </p>
<p>Not the greatest model but since we predicting over 5 classes (20% each) this actually isn't a horrible score.</p>
<p><em>(The purpose of this blog is to help you understand how to create model's for image classification. You can go ahead and do further readings and research to better understand how to create better model's based on tuning certain parameters.)</em></p>
<p><strong>Plot Results</strong></p>
<div class="highlight"><pre><span></span><span class="c1">#Plot Training and Testing Loss:</span>

<span class="c1"># Check out our train loss and test loss over epochs.</span>
<span class="n">train_loss</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;loss&#39;</span><span class="p">]</span>
<span class="n">test_loss</span> <span class="o">=</span> <span class="n">history</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="s1">&#39;val_loss&#39;</span><span class="p">]</span>

<span class="c1"># Set figure size.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Generate line plot of training, testing loss over epochs.</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_loss</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Training Loss&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#185fad&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_loss</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Testing Loss&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>

<span class="c1"># Set title</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Training and Testing Loss by Epoch&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Epoch&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Categorical Crossentropy&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span> <span class="o">=</span> <span class="mi">18</span><span class="p">);</span>
</pre></div>


<p><img alt="output_65_0.png" src="images/output_65_0.png"></p>
<p><strong>Check Final Model Score</strong></p>
<div class="highlight"><pre><span></span><span class="n">cnn_score</span> <span class="o">=</span> <span class="n">cnn_model</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">cnn_labels</span> <span class="o">=</span> <span class="n">cnn_model</span><span class="o">.</span><span class="n">metrics_names</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="mi">833</span><span class="o">/</span><span class="mi">833</span> <span class="p">[</span><span class="o">==============================</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span><span class="n">s</span> <span class="mi">5</span><span class="n">ms</span><span class="o">/</span><span class="n">sample</span> <span class="o">-</span> <span class="n">loss</span><span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">1380</span> <span class="o">-</span> <span class="n">acc</span><span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">6014</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;CNN {cnn_labels[0]}  : {cnn_score[0]}&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;CNN {cnn_labels[1]}   : {cnn_score[1]}&#39;</span><span class="p">)</span>
<span class="k">print</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">CNN</span> <span class="n">loss</span>  <span class="p">:</span> <span class="mi">1</span><span class="p">.</span><span class="mi">1379965717623644</span>
<span class="n">CNN</span> <span class="n">acc</span>   <span class="p">:</span> <span class="mi">0</span><span class="p">.</span><span class="mi">6014405488967896</span>
</pre></div>


<p><strong>Test Model:</strong></p>
<div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>

<span class="n">cnn_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">X_test</span><span class="p">[</span><span class="mi">0</span><span class="p">]]))</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">.</span><span class="mi">14482361</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">04204996</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">27279547</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00418275</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5361482</span> <span class="p">]],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="n">float32</span><span class="p">)</span>
</pre></div>


<p>If you remember from before when we made our classes our set up was :</p>
<p>0 - Baseball</p>
<p>1 - Basketball</p>
<p>2 - Football</p>
<p>3 - Hockey</p>
<p>4 - Soccer </p>
<p>Based on the given array output up top</p>
<p>array([[0.14482361, 0.04204996, 0.27279547, 0.00418275, 0.5361482 ]]</p>
<p>Image in (X_test[0]) is predicted to be 53% soccer which is the highest across all classes</p>
<div class="highlight"><pre><span></span><span class="n">y_pred_train</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">cnn_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))]</span>
<span class="n">label</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span><span class="p">:</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lb</span><span class="o">.</span><span class="n">classes_</span><span class="p">)}</span>
<span class="n">y_pred_train</span> <span class="o">=</span> <span class="p">[</span><span class="n">label</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">y_pred_train</span><span class="p">]</span>
<span class="n">y</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">array</span><span class="p">([</span><span class="s1">&#39;Baseball&#39;</span><span class="p">,</span> <span class="s1">&#39;Baseball&#39;</span><span class="p">,</span> <span class="s1">&#39;Baseball&#39;</span><span class="p">,</span> <span class="p">...,</span> <span class="s1">&#39;Soccer&#39;</span><span class="p">,</span> <span class="s1">&#39;Soccer&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Soccer&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U10&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">lb</span><span class="o">.</span><span class="n">classes_</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="nb">array</span><span class="p">([</span><span class="s1">&#39;Baseball&#39;</span><span class="p">,</span> <span class="s1">&#39;Basketball&#39;</span><span class="p">,</span> <span class="s1">&#39;Football&#39;</span><span class="p">,</span> <span class="s1">&#39;Hockey&#39;</span><span class="p">,</span> <span class="s1">&#39;Soccer&#39;</span><span class="p">],</span>
      <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;&lt;U10&#39;</span><span class="p">)</span>
</pre></div>


<p><strong>Inspect Predictions Using Confusion Matrix</strong></p>
<div class="highlight"><pre><span></span><span class="n">con_matrix</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">lb</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="n">y_pred_train</span><span class="p">)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">con_matrix</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">lb</span><span class="o">.</span><span class="n">classes_</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">lb</span><span class="o">.</span><span class="n">classes_</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Baseball</th>
      <th>Basketball</th>
      <th>Football</th>
      <th>Hockey</th>
      <th>Soccer</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Baseball</th>
      <td>350</td>
      <td>13</td>
      <td>89</td>
      <td>29</td>
      <td>123</td>
    </tr>
    <tr>
      <th>Basketball</th>
      <td>52</td>
      <td>136</td>
      <td>144</td>
      <td>58</td>
      <td>64</td>
    </tr>
    <tr>
      <th>Football</th>
      <td>48</td>
      <td>20</td>
      <td>368</td>
      <td>23</td>
      <td>101</td>
    </tr>
    <tr>
      <th>Hockey</th>
      <td>12</td>
      <td>17</td>
      <td>60</td>
      <td>335</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Soccer</th>
      <td>54</td>
      <td>15</td>
      <td>60</td>
      <td>5</td>
      <td>320</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="n">check</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;y_true&quot;</span><span class="p">:</span> <span class="n">lb</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">y_train</span><span class="p">),</span> <span class="s2">&quot;y_pred&quot;</span> <span class="p">:</span> <span class="n">y_pred_train</span><span class="p">})</span>
<span class="n">check</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>y_true</th>
      <th>y_pred</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Basketball</td>
      <td>Baseball</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Hockey</td>
      <td>Hockey</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Football</td>
      <td>Soccer</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Soccer</td>
      <td>Soccer</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Football</td>
      <td>Football</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Baseball</td>
      <td>Baseball</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Basketball</td>
      <td>Football</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Basketball</td>
      <td>Hockey</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Basketball</td>
      <td>Basketball</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Hockey</td>
      <td>Hockey</td>
    </tr>
  </tbody>
</table>
</div>

<p>Here you can see the first 10 images I have. The very first one is suppose to be a "Basketball" image but the model has predicted it to be "Baseball" which is unfortunate but once again the purpose of this blog is to help you understand the steps in creating a Image Classification Model.</p>
<p>Well there you go folks. We have successfully created an Image Classification Model. Hopefully this was simple enough for you to follow along. Thanks for reading!</p>
<div class="highlight"><pre><span></span>
</pre></div>
                    </section>
                    <hr/>
                    <aside class="post-meta">
                        <p>Category: <a href="https://vishalsharma01.github.io/Blog/category/misc.html">misc</a></p>
                        <p>Tags: <a href="https://vishalsharma01.github.io/Blog/tag/python.html">python</a>, </p>
                    </aside>
                    <hr/>
                </article>
            </li>
        </ol>
    </div>
        </div>

        <script src="https://vishalsharma01.github.io/Blog/theme/js/main.js"></script>
    </body>
</html>