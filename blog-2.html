<!DOCTYPE html>
<html lang="en">
<head>
 <title>LabelBinarizer vs get_dummies</title>
 <!-- Latest compiled and minified CSS -->
 <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
 <div class="container">
  <h1><a href="https://vishalsharma01.github.io/Blog">vishalsharma01</a></h1>
 </div>
</head>
<body>
 <div class="container">
<div class="row">
 <div class="col-md-8">
  <h3>LabelBinarizer vs get_dummies</h3>
  <label>2019-07-01</label>
  <p>LabelBinarizer and get_dummies are two features of Scikit-Learn/Pandas that are extremely crucial when it comes to transforming data for the purpose of train-test split (creating models and testing them). Like everything, they both come with their own set of pros and cons in terms of when it is appropriate to use them or when potentially using them can limit what you can do in terms of effectively creating models and its efficiency.</p>
<p>In this post we are going to explore how both of them work with data and by the end we will be able to see if one of these features may be better for us to use based on it's capabitilies.</p>
<p>To get started we will need to import some Python libraries and then create a DataFrame to run these features on.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelBinarizer</span><span class="p">;</span>
</pre></div>


<p><em>(get_dummies is a Pandas function and is used as: pd.get_dummies)</em></p>
<p><em>(LabelBinarizer is a SciKit-Learn function and can be imported seperately as we have done above without importing the entire SciKit-Learn library)</em></p>
<p>Let's get started with the pd.get_dummies function.</p>
<p>The purpose of this function is to take a column with categorical values and convert them into new columns consisting of numerical values (0 and 1). This has to be done for the modelling process as the algorthim would not be able to take in categorical values alone.</p>
<p>Let's try this out.</p>
<p>First off we need to create a DataFrame:</p>
<p><em>(I am going to create a DataFrame consisting of famous male and female athletes)</em></p>
<div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;James Harden&#39;</span><span class="p">,</span> <span class="s1">&#39;Serena Williams&#39;</span><span class="p">,</span> <span class="s1">&#39;Lionel Messi&#39;</span><span class="p">,</span> <span class="s1">&#39;Mike Trout&#39;</span><span class="p">,</span> <span class="s1">&#39;Tom Brady&#39;</span><span class="p">,</span> <span class="s1">&#39;Joe Thornton&#39;</span><span class="p">,</span> <span class="s1">&#39;Sania Mirza&#39;</span><span class="p">],</span>
    <span class="s1">&#39;sex&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">],</span>
    <span class="s1">&#39;sport&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;basketball&#39;</span><span class="p">,</span> <span class="s1">&#39;tennis&#39;</span><span class="p">,</span> <span class="s1">&#39;soccer&#39;</span><span class="p">,</span> <span class="s1">&#39;baseball&#39;</span><span class="p">,</span> <span class="s1">&#39;football&#39;</span><span class="p">,</span> <span class="s1">&#39;hockey&#39;</span><span class="p">,</span> <span class="s1">&#39;tennis&#39;</span><span class="p">],</span>
    <span class="s1">&#39;country&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="s1">&#39;Argentina&#39;</span><span class="p">,</span> <span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="s1">&#39;Canda&#39;</span><span class="p">,</span> <span class="s1">&#39;India&#39;</span><span class="p">],</span>
    <span class="s1">&#39;won_championship&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;yes&#39;</span><span class="p">]</span>
<span class="p">})</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>sex</th>
      <th>sport</th>
      <th>country</th>
      <th>won_championship</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>James Harden</td>
      <td>male</td>
      <td>basketball</td>
      <td>USA</td>
      <td>no</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Serena Williams</td>
      <td>female</td>
      <td>tennis</td>
      <td>USA</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lionel Messi</td>
      <td>male</td>
      <td>soccer</td>
      <td>Argentina</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mike Trout</td>
      <td>male</td>
      <td>baseball</td>
      <td>USA</td>
      <td>no</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tom Brady</td>
      <td>male</td>
      <td>football</td>
      <td>USA</td>
      <td>yes</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Joe Thornton</td>
      <td>male</td>
      <td>hockey</td>
      <td>Canda</td>
      <td>no</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Sania Mirza</td>
      <td>female</td>
      <td>tennis</td>
      <td>India</td>
      <td>yes</td>
    </tr>
  </tbody>
</table>
</div>

<p>Here you can see that we have created a table with data consisting of some famous male and female athletes from around the world. We have columns consisting of:</p>
<p>-Player name</p>
<p>-Sex</p>
<p>-The sport they play</p>
<p>-Nationality</p>
<p>Now let's take a closer look at our columns. All of our columns here have been inputted with categorical values. If we wanted to analyze this data and compare the variables this wouldn't be possible because as mentioned already we need to have numerical values to be able to do that such as 1's and 0's.</p>
<p>Taking a closer look we can see that two of our columns ('sex' and 'won championship') are populated with just two variables each: </p>
<p>'sex' = male or female and 'won championship' = yes or no.</p>
<p>Looking at this we can right away see that these categorical values can be quickly converted into numerics to be better represented. Lets go ahead and do that</p>
<div class="highlight"><pre><span></span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sex&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;female&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="c1">#*(here we are using the .replace() function to replace the categorical values &#39;male&#39; and &#39;female&#39; into 1 and 0 respectively)*</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;won_championship&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;won_championship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">([</span><span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="c1">#*(once again we are using .replace() to replace the &#39;yes&#39; and &#39;no&#39; in the &#39;won championship&#39; column into &#39;1&#39; and &#39;0&#39; as well)*</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>sex</th>
      <th>sport</th>
      <th>country</th>
      <th>won_championship</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>James Harden</td>
      <td>1</td>
      <td>basketball</td>
      <td>USA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Serena Williams</td>
      <td>0</td>
      <td>tennis</td>
      <td>USA</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lionel Messi</td>
      <td>1</td>
      <td>soccer</td>
      <td>Argentina</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mike Trout</td>
      <td>1</td>
      <td>baseball</td>
      <td>USA</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Tom Brady</td>
      <td>1</td>
      <td>football</td>
      <td>USA</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Joe Thornton</td>
      <td>1</td>
      <td>hockey</td>
      <td>Canda</td>
      <td>0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Sania Mirza</td>
      <td>0</td>
      <td>tennis</td>
      <td>India</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>

<p>In our new table you can now see that the 'sex' and 'won championship' columns have had their categorical values replaced with numerical values of 1 and 0.</p>
 </div>
</div>
 </div>
</body>
</html>